<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper 
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  

<mapper namespace="com.itbank.TechFarm.tftube.mybatis.ReplyMapper">

	<select id="replyList" resultType="replyDTO">
		select * from tftube_reply order by no desc
	</select>
	
	<select id="replyList_by_video" parameterType="String" resultType="replyDTO">
		select * from tftube_reply where video_name=#{video_name} order by no desc
	</select>		
	
	<select id="getName" resultType="String">
	select a.name  from  tfmember.member a  join tftube.tftube_reply b  on a.no = b.member_no
	</select>	
	
	<select id="getreply" resultType="replyDTO" parameterType="int">
		select * from tftube_reply where num = #{num}
	</select>
	
	<delete id="deletereply" parameterType="int">
		delete from tftube_reply where num = #{num}
	</delete>
	
	<insert id="insertReply" parameterType="replyDTO" useGeneratedKeys="true">	
		insert into tftube_reply 
		(member_no,content,video_name)
		values(#{member_no},#{content},#{video_name})		
	</insert>
	
	<update id="update_re_step">	
		update tftube_reply set re_step = re_step + 1
	</update>
	
	<update id="update_re_step_reply" parameterType="replyDTO">	
		update tftube_reply set re_step = re_step + 1 where re_step >= #{re_step}
	</update>
	
	<update id="updatereply" parameterType="replyDTO">
		update tftube_reply set writer=#{writer}, email=#{email},
		subject=#{subject}, content=#{content} where num=#{num}
	</update>
		
	<select id="getCount" resultType="int">
	select count(*) from tftube_reply
	</select>
	
	
	<select id="listreply" parameterType="java.util.HashMap" resultType="replyDTO">
 	select * from (select rownum rn,A.*from(select * from tftube_reply order by re_step asc)A)
	where rn between ${start} and ${end}
	</select>
	
	
	
	
	
</mapper>












